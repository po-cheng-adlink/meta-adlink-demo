From 7cc0d57f3f59524a15ee587b2f2c91d0ebe4c9e8 Mon Sep 17 00:00:00 2001
From: "po.cheng" <po.cheng@adlinktech.com>
Date: Tue, 3 Oct 2023 13:52:50 +0800
Subject: [PATCH] Compile with PRODUCT_ID_STR for fixed PID build

Signed-off-by: po.cheng <po.cheng@adlinktech.com>
---
 .../USB High Speed Electrical Test/USB_Linux_HSET.c       | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/General USB Examples/USB High Speed Electrical Test/USB_Linux_HSET.c b/General USB Examples/USB High Speed Electrical Test/USB_Linux_HSET.c
index cc6af85..6b8c18b 100644
--- a/General USB Examples/USB High Speed Electrical Test/USB_Linux_HSET.c	
+++ b/General USB Examples/USB High Speed Electrical Test/USB_Linux_HSET.c	
@@ -31,7 +31,7 @@ Author: Connor Chilton <connor.chilton@microchip.com>
 /* the buffer sizes can exceed the USB MTU */
 #define MAX_CTL_XFER	64
 #define MAX_BULK_XFER	512
-
+#define STRINGIFY(s)	#s
 
 /**
  * struct my_usb_device - struct that ties USB related stuff
@@ -69,8 +69,13 @@ int main(int argc, char **argv)
 	int err = 0;
 	int VENDOR_ID = 0x0424;
 	int PRODUCT_ID = 0;
+#ifdef PRODUCT_ID_STR
+	char PRODUCT_ID1[128] = STRINGIFY(PRODUCT_ID_STR);
+#else
 	char PRODUCT_ID1[128] = "";
+#endif
 
+#ifndef PRODUCT_ID_STR
 	INPUT:
 	printf("Please enter the product ID of the hub under test\n0x");
 	scanf("%s", PRODUCT_ID1);
@@ -90,6 +95,7 @@ int main(int argc, char **argv)
 	}
 	PRODUCT_ID = (int)strtol(PRODUCT_ID1, NULL, 16);
 
+#endif
 
 	printf("This demo will iniate a test mode on a port.\n");
 
-- 
2.25.1

